<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>YSU SensorTag v1: API: GATT related</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">YSU SensorTag v1
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">API: GATT related </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >Those APIs are used to create and manage services and their characteristics. Custom services can be created using the following APIs:</p><ul>
<li>SNP_addService</li>
<li>SNP_addCharValueDecl</li>
<li>SNP_addCharDescDecl</li>
<li>SNP_service_register</li>
</ul>
<p >Access to characteristics value can be done through a set of API. <br  />
</p>
<h1><a class="anchor" id="gatt_api"></a>
GATT API summary</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">commands Acronyms   </th><th class="markdownTableHeadNone">Origin   </th><th class="markdownTableHeadNone">Type   </th><th class="markdownTableHeadNone">TL Cmd0   </th><th class="markdownTableHeadNone">TL Cmd1   </th><th class="markdownTableHeadNone">Parameter structure    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">[SNP_addService_req] (<a class="el" href="_g_a_t_t.html#SNP_addService">Add a Service</a> )   </td><td class="markdownTableBodyNone">AP   </td><td class="markdownTableBodyNone">Sync Req   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga7aa4b6eb012a8d2d26c5990d473e9b6c" title="(0x35) Synchronous request type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_SYNC_REQ_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_ADD_SERVICE_REQ   </td><td class="markdownTableBodyNone">#snpAddServiceReq_t    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">[SNP_addService_rsp] (<a class="el" href="_g_a_t_t.html#SNP_addService">Add a Service</a> )   </td><td class="markdownTableBodyNone">NP   </td><td class="markdownTableBodyNone">Sync Rsp   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga6775b0a2a37cde4d10ecd78eae5ef7ce" title="(0x75) Synchronous response type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_SYNC_RSP_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_ADD_SERVICE_RSP   </td><td class="markdownTableBodyNone">#snpAddServiceRsp_t    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">[SNP_addCharValueDecl_req] (<a class="el" href="_g_a_t_t.html#SNP_addCharValueDecl">Add a Characteristic to a service</a> )   </td><td class="markdownTableBodyNone">AP   </td><td class="markdownTableBodyNone">Sync Req   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga7aa4b6eb012a8d2d26c5990d473e9b6c" title="(0x35) Synchronous request type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_SYNC_REQ_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_ADD_CHAR_VAL_DECL_REQ   </td><td class="markdownTableBodyNone">#snpAddCharValueDeclReq_t    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">[SNP_addCharValueDecl_rsp] (<a class="el" href="_g_a_t_t.html#SNP_addCharValueDecl">Add a Characteristic to a service</a> )   </td><td class="markdownTableBodyNone">NP   </td><td class="markdownTableBodyNone">Sync Rsp   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga6775b0a2a37cde4d10ecd78eae5ef7ce" title="(0x75) Synchronous response type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_SYNC_RSP_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_ADD_CHAR_VAL_DECL_RSP   </td><td class="markdownTableBodyNone">#snpAddCharValueDeclRsp_t    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">[SNP_addCharDescDecl_req] (<a class="el" href="_g_a_t_t.html#SNP_addCharDescDecl">Add a optional attribute to a characteristic</a> )   </td><td class="markdownTableBodyNone">AP   </td><td class="markdownTableBodyNone">Sync Req   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga7aa4b6eb012a8d2d26c5990d473e9b6c" title="(0x35) Synchronous request type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_SYNC_REQ_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_ADD_CHAR_DESC_DECL_REQ   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">[SNP_addCharDescDecl_rsp] (<a class="el" href="_g_a_t_t.html#SNP_addCharDescDecl">Add a optional attribute to a characteristic</a> )   </td><td class="markdownTableBodyNone">NP   </td><td class="markdownTableBodyNone">Sync Rsp   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga6775b0a2a37cde4d10ecd78eae5ef7ce" title="(0x75) Synchronous response type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_SYNC_RSP_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_ADD_CHAR_DESC_DECL_RSP   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">[SNP_registerService_req] (<a class="el" href="_g_a_t_t.html#SNP_registerService">Register a Service</a> )   </td><td class="markdownTableBodyNone">AP   </td><td class="markdownTableBodyNone">Sync Req   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga7aa4b6eb012a8d2d26c5990d473e9b6c" title="(0x35) Synchronous request type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_SYNC_REQ_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_REGISTER_SERVICE_REQ   </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">[SNP_registerService_rsp] (<a class="el" href="_g_a_t_t.html#SNP_registerService">Register a Service</a> )   </td><td class="markdownTableBodyNone">NP   </td><td class="markdownTableBodyNone">Sync Rsp   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga6775b0a2a37cde4d10ecd78eae5ef7ce" title="(0x75) Synchronous response type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_SYNC_RSP_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_REGISTER_SERVICE_RSP   </td><td class="markdownTableBodyNone">#snpRegisterServiceRsp_t    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">[SNP_getAttrValue_req] (<a class="el" href="_g_a_t_t.html#SNP_getAttrValue">Get Attribute Value</a> )   </td><td class="markdownTableBodyNone">AP   </td><td class="markdownTableBodyNone">Sync Req   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga7aa4b6eb012a8d2d26c5990d473e9b6c" title="(0x35) Synchronous request type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_SYNC_REQ_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_GET_ATTR_VALUE_REQ   </td><td class="markdownTableBodyNone">#snpGetAttrValueReq_t    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">[SNP_getAttrValue_rsp] (<a class="el" href="_g_a_t_t.html#SNP_getAttrValue">Get Attribute Value</a> )   </td><td class="markdownTableBodyNone">NP   </td><td class="markdownTableBodyNone">Sync Rsp   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga6775b0a2a37cde4d10ecd78eae5ef7ce" title="(0x75) Synchronous response type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_SYNC_RSP_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_GET_ATTR_VALUE_RSP   </td><td class="markdownTableBodyNone">#snpGetAttrValueRsp_t    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">[SNP_setAttrValue_req] (<a class="el" href="_g_a_t_t.html#SNP_setAttrValue">Set GATT parameters</a> )   </td><td class="markdownTableBodyNone">AP   </td><td class="markdownTableBodyNone">Sync Req   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga7aa4b6eb012a8d2d26c5990d473e9b6c" title="(0x35) Synchronous request type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_SYNC_REQ_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_SET_ATTR_VALUE_REQ   </td><td class="markdownTableBodyNone">#snpSetAttrValueReq_t    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">[SNP_setAttrValue_rsp] (<a class="el" href="_g_a_t_t.html#SNP_setAttrValue">Set GATT parameters</a> )   </td><td class="markdownTableBodyNone">NP   </td><td class="markdownTableBodyNone">Sync Rsp   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga6775b0a2a37cde4d10ecd78eae5ef7ce" title="(0x75) Synchronous response type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_SYNC_RSP_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_SET_ATTR_VALUE_RSP   </td><td class="markdownTableBodyNone">#snpSetAttrValueRsp_t    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">[SNP_charRead_ind] (<a class="el" href="_g_a_t_t.html#SNP_charRead">Characteristic read indication</a> )   </td><td class="markdownTableBodyNone">NP   </td><td class="markdownTableBodyNone">Async   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga9baba627781c846634ce07570d2e8dc1" title="(0x55) Asynchronous Command type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_ASYNC_CMD_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_CHAR_READ_IND   </td><td class="markdownTableBodyNone">#snpCharReadInd_t    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">[SNP_charRead_cnf] (<a class="el" href="_g_a_t_t.html#SNP_charRead">Characteristic read indication</a> )   </td><td class="markdownTableBodyNone">AP   </td><td class="markdownTableBodyNone">Async   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga9baba627781c846634ce07570d2e8dc1" title="(0x55) Asynchronous Command type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_ASYNC_CMD_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_CHAR_READ_CNF   </td><td class="markdownTableBodyNone">#snpCharReadCnf_t    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">[SNP_charWrite_ind] (<a class="el" href="_g_a_t_t.html#SNP_charWrite">Characteristic write indication</a> )   </td><td class="markdownTableBodyNone">NP   </td><td class="markdownTableBodyNone">Async   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga9baba627781c846634ce07570d2e8dc1" title="(0x55) Asynchronous Command type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_ASYNC_CMD_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_CHAR_WRITE_IND   </td><td class="markdownTableBodyNone">#snpCharWriteInd_t    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">[SNP_charWrite_cnf] (<a class="el" href="_g_a_t_t.html#SNP_charWrite">Characteristic write indication</a> )   </td><td class="markdownTableBodyNone">AP   </td><td class="markdownTableBodyNone">Async   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga9baba627781c846634ce07570d2e8dc1" title="(0x55) Asynchronous Command type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_ASYNC_CMD_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_CHAR_WRITE_CNF   </td><td class="markdownTableBodyNone">#snpCharWriteCnf_t    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">[SNP_sendNotifInd_req] (<a class="el" href="_g_a_t_t.html#SNP_sendNotifInd">Sending Notification or Indication</a> )   </td><td class="markdownTableBodyNone">AP   </td><td class="markdownTableBodyNone">Async   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga9baba627781c846634ce07570d2e8dc1" title="(0x55) Asynchronous Command type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_ASYNC_CMD_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_SEND_NOTIF_IND_REQ   </td><td class="markdownTableBodyNone">#snpNotifIndReq_t    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">[SNP_sendNotifInd_rsp] (<a class="el" href="_g_a_t_t.html#SNP_sendNotifInd">Sending Notification or Indication</a> )   </td><td class="markdownTableBodyNone">NP   </td><td class="markdownTableBodyNone">Async   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga9baba627781c846634ce07570d2e8dc1" title="(0x55) Asynchronous Command type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_ASYNC_CMD_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_SEND_NOTIF_IND_CNF   </td><td class="markdownTableBodyNone">#snpNotifIndCnf_t    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">[SNP_charConfigUpdated_req] (<a class="el" href="_g_a_t_t.html#SNP_charConfigUpdated">CCCD update indication</a> )   </td><td class="markdownTableBodyNone">NP   </td><td class="markdownTableBodyNone">Async   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga9baba627781c846634ce07570d2e8dc1" title="(0x55) Asynchronous Command type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_ASYNC_CMD_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_CCCD_UPDATED_IND   </td><td class="markdownTableBodyNone">#snpCharCfgUpdatedInd_t    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">[SNP_charConfigUpdated_rsp] (<a class="el" href="_g_a_t_t.html#SNP_charConfigUpdated">CCCD update indication</a> )   </td><td class="markdownTableBodyNone">AP   </td><td class="markdownTableBodyNone">Async   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga9baba627781c846634ce07570d2e8dc1" title="(0x55) Asynchronous Command type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_ASYNC_CMD_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_CCCD_UPDATED_CNF   </td><td class="markdownTableBodyNone">#snpCharCfgUpdatedRsp_t    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">[SNP_setGATTparam_req] (<a class="el" href="_g_a_t_t.html#SNP_setGATTparam">Set GATT parameters</a> )   </td><td class="markdownTableBodyNone">AP   </td><td class="markdownTableBodyNone">Sync Req   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga7aa4b6eb012a8d2d26c5990d473e9b6c" title="(0x35) Synchronous request type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_SYNC_REQ_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_SET_GATT_PARAM_REQ   </td><td class="markdownTableBodyNone">#snpSetGattParamReq_t    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">[SNP_setGATTparam_rsp] (<a class="el" href="_g_a_t_t.html#SNP_setGATTparam">Set GATT parameters</a> )   </td><td class="markdownTableBodyNone">NP   </td><td class="markdownTableBodyNone">Sync Rsp   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga6775b0a2a37cde4d10ecd78eae5ef7ce" title="(0x75) Synchronous response type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_SYNC_RSP_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_SET_GATT_PARAM_RSP   </td><td class="markdownTableBodyNone">#snpSetGattParamRsp_t    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">[SNP_getGATTparam_req] (<a class="el" href="_g_a_t_t.html#SNP_getGATTparam">Get GATT parameters</a> )   </td><td class="markdownTableBodyNone">AP   </td><td class="markdownTableBodyNone">Sync Req   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga7aa4b6eb012a8d2d26c5990d473e9b6c" title="(0x35) Synchronous request type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_SYNC_REQ_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_GET_GATT_PARAM_REQ   </td><td class="markdownTableBodyNone">#snpGetGattParamReq_t    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">[SNP_getGATTparam_rsp] (<a class="el" href="_g_a_t_t.html#SNP_getGATTparam">Get GATT parameters</a> )   </td><td class="markdownTableBodyNone">NP   </td><td class="markdownTableBodyNone">Sync Rsp   </td><td class="markdownTableBodyNone"><a class="el" href="group___s_n_p___n_p_i___t_y_p_e.html#ga6775b0a2a37cde4d10ecd78eae5ef7ce" title="(0x75) Synchronous response type for the BLE simple network processor (cmd0 field of npi frame)">SNP_NPI_SYNC_RSP_TYPE</a>   </td><td class="markdownTableBodyNone">#SNP_GET_GATT_PARAM_RSP   </td><td class="markdownTableBodyNone">#snpGetGattParamRsp_t   </td></tr>
</table>
<p >All those command have some parameters. those parameters can be set using the indicated packed structure. Note that all parameters/structure field should be in little-endian format (LSB first). for UUID parameters, take a look at UUID_desc</p>
<p >Services and characteristic cannot be added if a device has started. Device start when the start advertisement command or the set advertisement command is send to the SNP. Once started, the only way to stop the device is to reset it.</p>
<h1><a class="anchor" id="SNP_addService"></a>
Add a Service</h1>
<p >This API starts the addition of a new service to the GATT server running on the NP. Another SNP command must be used to add additional characteristic to the service. See <a class="el" href="_g_a_t_t.html#SNP_addCharValueDecl">Add a Characteristic to a service</a> and <a class="el" href="_g_a_t_t.html#SNP_addCharDescDecl">Add a optional attribute to a characteristic</a></p>
<p >Only one service can be added at a time. Once this command has been set, the service need to be register before being able to add another service. Registering a service is done by sending the register service command, see #SNP_registerService</p>
<p >This SNP_addService_req request takes as parameter the structure #snpAddServiceReq_t .</p>
<p >The SNP_addService_rsp response uses as parameter the structure #snpAddServiceRsp_t .</p>
<p >The snpAddServiceReq_t has a UUID field. please check UUID_desc to know more about how to use UUID field.</p>
<p >Limitation:</p><ul>
<li>services and characteristic definitions are not store in flash.</li>
<li>If a reset of the NP occurs, all services and characteristics created by the NP are lost and need to be setup again.</li>
</ul>
<h1><a class="anchor" id="SNP_addCharValueDecl"></a>
Add a Characteristic to a service</h1>
<p >User can create their own custom services. User needs to know what he wants and how services and characteristics are working. Consider reading BLE core spec, vol 3, Part G, chapter 3. To give enough flexibility to create a custom service, the following commands are available:</p><ul>
<li>SNP_addCharValueDecl</li>
<li>SNP_addCharDescDecl <br  />
</li>
</ul>
<p >The SNP_addCharValueDecl command will add the following attribute to the service:</p><ul>
<li>Characteristic declaration.</li>
<li>Characteristic value declaration.</li>
</ul>
<p >Note that those attributes are the only ones mandatory per BLE specification. All others attributes are optional. This API always needs to be call first when adding a new characteristic to a service. Other attributes can be added with a call to <a class="el" href="_g_a_t_t.html#SNP_addCharDescDecl">Add a optional attribute to a characteristic</a>.</p>
<p >If the NOTIFY and INDICATE properties are enable, the CCCD attribute must be added (using <a class="el" href="_g_a_t_t.html#SNP_addCharDescDecl">Add a optional attribute to a characteristic</a>), or those properties will never been usable.</p>
<p >The option bit field is reserve for future used. characteristics value is managed by the AP:</p><ul>
<li>If a GATT client request a read, the NP GATT server forward the request to the AP. The AP has 30s to send the response. Characteristic value is not stored on the NP. AP needs to store them if needed.</li>
<li>If a GATT client request a write, the NP GATT server forward the request to the AP. The AP has 30s to send the response. Characteristic value is not stored on the NP. AP needs to store them if needed.</li>
</ul>
<p >This SNP_addCharValueDecl_req request takes as parameter the structure #snpAddCharValueDeclReq_t .</p>
<p >The SNP_addCharValueDecl_rap response uses as parameter the structure #snpAddCharValueDeclRsp_t .</p>
<p >The #snpAddCharValueDeclReq_t structure has a permission field. Attribute permissions are define by higher layer profile or are implementation specific. TI BLE STACK has define its own value for this field. it is also performing basic filtering using those value (e.g. a read request on a characteristic value those not permit read will be rejected by the stack directly). Permission value are define here: <a class="el" href="group___s_n_p___p_e_r_m_i_t___b_i_t_m_a_p_s___d_e_f_i_n_e_s.html">GATT Attribute Access Permissions Bit Fields</a></p>
<p >The #snpAddCharValueDeclReq_t structure has a property field. Attribute properties are defined by the BLE specification. TI BLE STACK expect the properties to be align logically with the permission, meaning a read permission should lead to a the read properties enable. <br  />
 Properties value are define here: <a class="el" href="group___s_n_p___p_r_o_p___b_i_t_m_a_p_s___d_e_f_i_n_e_s.html">GATT Characteristic Properties Bit Fields</a></p>
<h1><a class="anchor" id="SNP_addCharDescDecl"></a>
Add a optional attribute to a characteristic</h1>
<p >This API is used to add the following attributes to the service:</p><ul>
<li>User description.</li>
<li>Characteristic Client Characteristic Configuration (CCCD).</li>
<li>Presentation format.</li>
<li>Server Characteristic configuration (RFU).</li>
<li>Aggregate format. (RFU)</li>
<li>generic attribute using short UUID (2 bytes)</li>
<li>generic attribute using long UUID (16 bytes)</li>
</ul>
<p >The attribute permission for the user description is force to READ ONLY.</p>
<p >All those attributes are optional. But at least one needs to be added when this API is call. CCCD, presentation format and user description attribute can only be present each once for each characteristic. Trying to create a second one will lead to a #SNP_CMD_REJECTED error.</p>
<p >The first parameter of the API is a header indicating which attribute need to be added. When a bit is set, the corresponding attribute is present on the following parameters and will be added to the characteristic. The parameter for an attribute needs to appear in the same order as the bit appear in the header.</p>
<p >For example, if both CCCD and user description attribute needs to be added. Then the header will have the value 0x5 (b101). The CCCD parameter (1 byte) will then follow the header, and the user description parameter (N Bytes) will follow the CCCD parameter. Other parameters must be omitted.</p>
<p >the SNP_addCharDescDecl_req command TL frame is the following:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone"><a class="el" href="union_header.html">Header</a> (1 Bytes)   </th><th class="markdownTableHeadNone">Generic short UUID (5 Byte) <br  />
 present only if bit set in header   </th><th class="markdownTableHeadNone">Generic long UUID (19 Byte) <br  />
 present only if bit set in header   </th><th class="markdownTableHeadNone">CCCD (1 Byte) <br  />
 present only if bit set in header   </th><th class="markdownTableHeadNone">Format (7 Bytes) <br  />
 present only if bit set in header   </th><th class="markdownTableHeadNone">User Description (N Bytes) <br  />
 present only if bit set in header    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">bit 7: user Descr <br  />
 bit 6:4 RFU <br  />
 bit 3: Format Descr. <br  />
 bit 2 : CCCD <br  />
 bit 1: Generic-Long UUID <br  />
 bit 0 : Generic-Short UUID   </td><td class="markdownTableBodyNone">#snpAddAttrGenShortUUID_t   </td><td class="markdownTableBodyNone">#snpAddAttrGenLongUUID_t   </td><td class="markdownTableBodyNone">#snpAddAttrCccd_t   </td><td class="markdownTableBodyNone">#snpAddAttrFormat_t   </td><td class="markdownTableBodyNone">#snpAddAttrUserDesc_t   </td></tr>
</table>
<p >The Generic Short UUID descriptor parameters are mapped on structure #snpAddAttrGenShortUUID_t</p>
<p >The Generic Long UUID descriptor parameters are mapped on structure #snpAddAttrGenLongUUID_t</p>
<p >The CCCD descriptor parameters are mapped on structure #snpAddAttrCccd_t</p>
<p >The format descriptor parameters are mapped on structure #snpAddAttrFormat_t</p>
<p >The user descriptor parameters are mapped on structure #snpAddAttrUserDesc_t</p>
<p >The #snpAddAttrCccd_t structure has a permission field. Attribute permissions are define by higher layer profile or are implementation specific. TI BLE STACK has define its own value for this field. It is also performing basic filtering using those values (e.g. a read request on a characteristic value those not permit read will be rejected by the stack directly). Permission value are define here: <a class="el" href="group___s_n_p___p_e_r_m_i_t___b_i_t_m_a_p_s___d_e_f_i_n_e_s.html">GATT Attribute Access Permissions Bit Fields</a>.</p>
<p >The SNP_addCharDescDecl_rsp will use the same concept has the SNP_addCharDescDecl_req. A header will describe which attribute has been added. If a bit is set, the corresponding attribute has been added and the handle value is indicated in the parameters following the header.</p>
<p >The SNP_addCharDescDecl_rsp command TL frame is the following:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Status   </th><th class="markdownTableHeadNone"><a class="el" href="union_header.html">Header</a> (1 Bytes)   </th><th class="markdownTableHeadNone">Generic short UUID (2 Bytes) <br  />
 present only if bit set in header   </th><th class="markdownTableHeadNone">Generic long UUID (2 Bytes) <br  />
 present only if bit set in header   </th><th class="markdownTableHeadNone">CCCD handle (2 bytes) <br  />
 present only if bit set in header   </th><th class="markdownTableHeadNone">Format handle (2 Bytes) <br  />
 present only if bit set in header   </th><th class="markdownTableHeadNone">User Descr handle (2 Bytes) <br  />
 present only if bit set in header    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">status of the operation   </td><td class="markdownTableBodyNone">bit 7: user Descr <br  />
 bit 6:4 RFU <br  />
 bit 3: Format Descr. <br  />
 bit 2 : CCCD <br  />
 bit 1: Generic-Long UUID <br  />
 bit 0 : Generic-Short UUID   </td><td class="markdownTableBodyNone">16-bit assigned attribute handle   </td><td class="markdownTableBodyNone">16-bit assigned attribute handle   </td><td class="markdownTableBodyNone">16-bit assigned attribute handle   </td><td class="markdownTableBodyNone">16-bit assigned attribute handle   </td><td class="markdownTableBodyNone">16-bit assigned attribute handle   </td></tr>
</table>
<pre class="fragment">@subsection about_CCCD About CCCD
  If the NOTIFY and INDICATE properties are enabled, the CCCD attribute must be added, or those properties will never been usable.

  This attribute has some default permission set at BLE core spec level : it is always readable without authentication or authorization. 
  However, right of this characteristic by a remote GATT client is subject to authentication or authorization by a higher layer.
  Since security in not enable yet, the automatic management of this authentication/authorization is not done by the BLE stack. 
  Therefore this is implementation specific. When this write request comes for this CCCD from the GATT client, it is forwarded to the AP for validation through the @ref SNP_charConfigUpdated command.
  This is an ATT transaction, the application has 30s to confirm the update or return an error (if the application does not allow the attribute value to be update, it must reply an error).

  The AP needs to reply with the SNP_charConfigUpdated_rsp to confirm that it allows the write to the attribute value (or not).
</pre> <h1><a class="anchor" id="SNP_registerService"></a>
Register a Service</h1>
<p >This command will register the service and characteristic previously added with the GATT server.</p>
<p >This SNP_registerService_req request takes no parameters</p>
<p >The SNP_registerService_rsp response uses as parameter the structure #snpRegisterServiceRsp_t . The SNP_registerService_rsp return the first attribute handle and the last attribute handle of the service.</p>
<p >Limitation:</p><ul>
<li>Services and characteristic definitions are not store in flash.</li>
<li>If a reset of the NP occurs, all services and characteristics created by the NP are lost and need to be setup again.</li>
</ul>
<h1><a class="anchor" id="SNP_getAttrValue"></a>
Get Attribute Value</h1>
<p >This action read the value of a attribute managed by the GATT server in the NP.</p>
<p >This API can be used to get the user description attribute value, and format attribute value. Those values are managed by the GATT server and are therefore always store in the NP.</p>
<p >For other attribute, this is RFU, since no characteristic value will be store in the NP for custom services. For embedded service services, the API SNP_getGATTparam should be used.</p>
<p >If the char value is managed by the AP, this request will be rejected.</p>
<p >This SNP_getAttrValue_req request takes as parameter the structure #snpGetAttrValueReq_t .</p>
<p >The SNP_getAttrValue_rsp response uses as parameter the structure #snpGetAttrValueRsp_t .</p>
<p >The list of parameters for the device information service can be found here: <a class="el" href="group___s_n_p___d_e_v___i_n_f_o___s_e_r_v_i_c_e.html">Device Information Service Parameters</a> The list of parameters for the GAP/GATT service can be found here: <a class="el" href="group___s_n_p___g_a_p___s_e_r_v_i_c_e.html">GAP GATT Server Parameters</a></p>
<h1><a class="anchor" id="SNP_setAttrValue"></a>
Set GATT parameters</h1>
<p >If the characteristic value is managed by the NP (like the user descriptor attribute), this command is used to update the value. This value must not be bigger than 512 Bytes.</p>
<p >This API can be used to update the user description attribute value and format attribute value. Those values are managed by the GATT server and are therefore always store in the NP.</p>
<p >For other attribute, this is RFU, since no characteristic value will be store in the NP for custom services. For embedded services, the API SNP_setGATTparam should be used.</p>
<p >The length should never exceed the maximum length of the attribute value.</p>
<p >If the char value is managed by the AP, this request will be rejected.</p>
<p >The SNP_setAttrValue_req request takes as parameter the structure #snpSetAttrValueReq_t .</p>
<p >The SNP_setAttrValue_rsp response uses as parameter the structure #snpSetAttrValueRsp_t .</p>
<h1><a class="anchor" id="SNP_charRead"></a>
Characteristic read indication</h1>
<p >The SNP_charRead_ind Event is sent by the SNP when a remote GATT client wants to read a characteristic value manage by the AP. The AP needs to answer with a SNP_charRead_rsp within 30s. Note that a characteristic value can be up to 512 Bytes long. However, not more than ATT_MTU_SIZE can be read at once by a ATT operation. If the characteristic size is bigger than ATT_MTU_SIZE, the remote GATT client will send several read, until it reads all the value it needs. There is several different way for the GATT client to read fully a characteristic, in order not to over-complicate the SNP design, each read request send by the client is translated in a SNP_charRead_req with two parameters: an offset and the maximum data size. The offset represent the start of the data to read, the maximum data size represent maximum size to answer. The AP needs to reply with the SNP_charRead_rsp command. It will indicate in this command the offset the data were read from, the size of the data and the data. The default ATT_MTU_SIZE is set to 27. If the size change (negotiate between GATT server and GATT client), then a MTU SIZE event will be send by the NP to the AP ( <a class="el" href="_d_e_v.html#SNP_Event_ind">SNP Event indication</a>). The AP cannot initiate such a change.</p>
<p >This SNP_charRead_ind indication is mapped on the #snpCharReadInd_t structure .</p>
<p >This SNP_charRead_cnf confirmation is mapped on the #snpCharReadCnf_t structure .</p>
<h1><a class="anchor" id="SNP_charWrite"></a>
Characteristic write indication</h1>
<p >The SNP_charWrite_ind Event is sent by the SNP when a remote GATT client wants to write a characteristic value manage by the AP. The AP needs to answer with a SNP_charWrite_rsp within 30s. Note that the GATT client may request a partial write, hence the usage of the offset where the write should begin relatively to the beginning of the characteristic value (the offset is a number of Bytes). Note: the characteristic value length is application specific. Neither the SNP or the AP NP library know the length of the characteristic value. Some applications may in some cases use unknown variable length. To enable those cases, the SNP is configured to be able to manage 512 Bytes char value length whatever the ATT_MTU_SIZE is negotiated to.</p>
<p >Once a remote GATT client start to write a char value with offset 0, this means it will write the entire value (4.9.4, Part G, Vol3). If the remote side start to write with an offset different than 0, this means it is a partial write.</p>
<p >In any case, it is the responsibility of the application to know the length of each characteristic value.</p>
<p >The snpCharWriteInd_t::rspNeeded field set to 1 indicates that the AP must send the SNP_charWrite_rsp back within 30s. If this field is set to 0, the SNP_charWrite_rsp is not needed. This last case can happen if a ATT_WRITE_CMD operation has been used by the remote GATT client. If a confirmation is send anyway, it will be ignore by the NP.</p>
<p >The application can also have their own permission mechanism and rules. In this case it is the responsibility of the application to deny the writing of the value by return a error status with SNP_charRead_cnf. This SNP_charWrite_ind indication is mapped on the #snpCharWriteInd_t structure.</p>
<p >This SNP_charWrite_cnf confirmation is mapped on the #snpCharWriteCnf_t structure.</p>
<h1><a class="anchor" id="SNP_sendNotifInd"></a>
Sending Notification or Indication</h1>
<p >The SNP_charRead_ind Event send a notification or an indication for a characteristic value. Note that notifications and indications are managed by the GATT server, and will only be sent to GATT client that are actually requesting for them.</p>
<p >If a notification/indication is send to a GATT client that did not enabled it, a error #SNP_NOTIF_IND_NOT_ENABLE_BY_CLIENT will be return in the status of SNP_sendNotiInd_rsp.</p>
<p >If a notification/indication is send for a characteristic which does not have this properties enabled, a error #SNP_NOTIF_IND_NOT_ALLOWED will be return.</p>
<p >If a notification/indication is send for a characteristic value, which has the properties enable, but has no CCCD attribute descriptor, a error #SNP_NOTIF_IND_NO_CCCD_ATTRIBUTE will be return.</p>
<p >Indication requires that the remote GATT client sends a confirmation. Once the confirmation is received form the GATT client, the SNP_ sendNotiInd_rsp command will be send back by the SNP, with the status SUCCESS. If the confirmation is not received from the GATT client within 30s, the SNP_ sendNotiInd_rsp will be send back by the SNP with the status FAILURE. If a timeout occurs while sending an indication, no more indication should be send while the connection is established.</p>
<p >Notification does not require that the remote GATT clients send a confirmation. The SNP_ sendNotiInd_rsp will be reply once the notification has been forwarded successfully to the BLE host.</p>
<p >This SNP_sendNotifInd_req confirmation is mapped on the #snpNotifIndReq_t structure.</p>
<p >This SNP_sendNotifcnf_rsp is mapped on the #snpNotifIndCnf_t structure.</p>
<p >The maximum size possible for a notification or indication value is ATT_MTU_SIZE. if the value send within the command is bigger, it will be truncated.</p>
<p >Limitation:</p><ul>
<li>Authentication is not supported .</li>
</ul>
<h1><a class="anchor" id="SNP_setGATTparam"></a>
Set GATT parameters</h1>
<p >This API enables the update of parameters of predefined service. The device information service and the GAP/GATT service are predefined service always present in the NP.</p>
<p >This SNP_setGATTparam_req request takes as parameter the structure #snpSetGattParamReq_t .</p>
<p >The SNP_setGATTparam_rsp response uses as parameter the structure #snpSetGattParamRsp_t .</p>
<p >The list of parameters for the device information service can be found here: <a class="el" href="group___s_n_p___d_e_v___i_n_f_o___s_e_r_v_i_c_e.html">Device Information Service Parameters</a> The list of parameters for the GAP/GATT service can be found here: <a class="el" href="group___s_n_p___g_a_p___s_e_r_v_i_c_e.html">GAP GATT Server Parameters</a></p>
<h1><a class="anchor" id="SNP_getGATTparam"></a>
Get GATT parameters</h1>
<p >This API enables the reading of parameters of predefined service.</p>
<p >The SNP_getGATTparam_req request takes as parameter the structure #snpGetGattParamReq_t .</p>
<p >The SNP_getGATTparam_rsp response uses as parameter the structure #snpGetGattParamRsp_t .</p>
<h1><a class="anchor" id="SNP_charConfigUpdated"></a>
CCCD update indication</h1>
<p >The SNP_charConfigUpdated_req Event is sent by the SNP when a remote GATT client request to update the CCCD value(to enable notification or indication). The AP is responsible to remember the CCCD attribute for the GATT client if needed. The AP is responsible to accept (authorize) the modification of the CCCD. In the case notification has been enabled, the AP is able to notify or indicate the remote GATT client that the characteristic value has changed by calling API SNP_send_notiInd_req. Only one indication can be send at a time to a particular client. To send a new indication to the same client, the AP must wait the SNP_charConfigUpdated_rsp, see <a class="el" href="_g_a_t_t.html#SNP_charConfigUpdated">CCCD update indication</a>.</p>
<p >The snpCharWriteInd_t::rspNeeded field set to 1 indicates that the AP must send the SNP_charConfigUpdated_rap back within 30s. <br  />
 if the field is set to 0, the SNP_charConfigUpdated_rsp is not needed. This last case can happen if a ATT_WRITE_CMD operation has been used by the remote GATT client. If a confirmation is send anyway, it will be ignore by the NP.</p>
<p >This SNP_charConfigUpdated_req request is mapped on the #snpCharCfgUpdatedInd_t structure.</p>
<p >This SNP_charConfigUpdated_rsp confirmation is mapped on the #snpCharCfgUpdatedRsp_t structure. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>
